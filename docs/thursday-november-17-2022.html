<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Thursday November 17, 2022 | GIS5122: Applied Spatial Statistics</title>
  <meta name="description" content="Thursday November 17, 2022 | GIS5122: Applied Spatial Statistics" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Thursday November 17, 2022 | GIS5122: Applied Spatial Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="jelsner/ASS-2022" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Thursday November 17, 2022 | GIS5122: Applied Spatial Statistics" />
  
  
  

<meta name="author" content="James B. Elsner" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tuesday-november-15-2022.html"/>
<link rel="next" href="thursday-november-29-2022.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<script src="libs/Leaflet.Sync-0.0.5/L.Map.Sync.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Spatial Statistics</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i>Syllabus</a>
<ul>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#contact-information"><i class="fa fa-check"></i>Contact information</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#course-description-and-expected-learning-outcomes"><i class="fa fa-check"></i>Course description and expected learning outcomes</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#materials-and-class-meetings"><i class="fa fa-check"></i>Materials and class meetings</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#grades-and-ethics"><i class="fa fa-check"></i>Grades and ethics</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#outline-of-topics-and-schedule"><i class="fa fa-check"></i>Outline of topics and schedule</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#reference-materials"><i class="fa fa-check"></i>Reference materials</a></li>
<li class="chapter" data-level="" data-path="syllabus.html"><a href="syllabus.html#reproducible-research"><i class="fa fa-check"></i>Reproducible research</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html"><i class="fa fa-check"></i>Tuesday, August 23, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#install-r-and-rstudio-on-your-computer"><i class="fa fa-check"></i>Install R and RStudio on your computer</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#download-course-materials"><i class="fa fa-check"></i>Download course materials</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#read-the-syllabus"><i class="fa fa-check"></i>Read the syllabus</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#about-rstudio"><i class="fa fa-check"></i>About RStudio</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#lab-assignments"><i class="fa fa-check"></i>Lab assignments</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#getting-started-with-r"><i class="fa fa-check"></i>Getting started with R</a></li>
<li class="chapter" data-level="" data-path="tuesday-august-23-2022.html"><a href="tuesday-august-23-2022.html#are-you-completely-new-to-r"><i class="fa fa-check"></i>Are you completely new to R?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html"><i class="fa fa-check"></i>Thursday, August 25, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#expectations"><i class="fa fa-check"></i>Expectations</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#data-science-workflow-with-r-markdown"><i class="fa fa-check"></i>Data science workflow with R markdown</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#an-introduction-to-using-r"><i class="fa fa-check"></i>An introduction to using R</a></li>
<li class="chapter" data-level="" data-path="thursday-august-25-2022.html"><a href="thursday-august-25-2022.html#data-frames"><i class="fa fa-check"></i>Data frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html"><i class="fa fa-check"></i>Tuesday August 30, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-august-30-2022.html"><a href="tuesday-august-30-2022.html#working-with-data-frames"><i class="fa fa-check"></i>Working with data frames</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html"><i class="fa fa-check"></i>Thursday September 1, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-1-2022.html"><a href="thursday-september-1-2022.html#making-graphs"><i class="fa fa-check"></i>Making graphs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html"><i class="fa fa-check"></i>Thursday September 8, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html#working-with-spatial-data"><i class="fa fa-check"></i>Working with spatial data</a></li>
<li class="chapter" data-level="" data-path="thursday-september-8-2022.html"><a href="thursday-september-8-2022.html#geo-computation-on-simple-features"><i class="fa fa-check"></i>Geo-computation on simple features</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html"><i class="fa fa-check"></i>Tuesday September 13, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html#spatial-data-subsets-and-joins"><i class="fa fa-check"></i>Spatial data subsets and joins</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-13-2022.html"><a href="tuesday-september-13-2022.html#interpolation-using-areal-weights"><i class="fa fa-check"></i>Interpolation using areal weights</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-15-2022.html"><a href="thursday-september-15-2022.html"><i class="fa fa-check"></i>Thursday September 15, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-15-2022.html"><a href="thursday-september-15-2022.html#s4-spatial-data-objects"><i class="fa fa-check"></i>S4 spatial data objects</a></li>
<li class="chapter" data-level="" data-path="thursday-september-15-2022.html"><a href="thursday-september-15-2022.html#working-with-raster-data"><i class="fa fa-check"></i>Working with raster data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html"><i class="fa fa-check"></i>Tuesday September 20, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#working-with-space-time-data"><i class="fa fa-check"></i>Working with space-time data</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#mapping-using-functions-from-the-ggplot2-package"><i class="fa fa-check"></i>Mapping using functions from the {ggplot2} package</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#mapping-using-functions-from-the-tmap-package"><i class="fa fa-check"></i>Mapping using functions from the {tmap} package</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#creating-an-interactive-map"><i class="fa fa-check"></i>Creating an interactive map</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-20-2022.html"><a href="tuesday-september-20-2022.html#adding-an-inset-map"><i class="fa fa-check"></i>Adding an inset map</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-september-27-2022.html"><a href="tuesday-september-27-2022.html"><i class="fa fa-check"></i>Tuesday September 27, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-september-27-2022.html"><a href="tuesday-september-27-2022.html#defining-spatial-neighborhoods-and-spatial-weights"><i class="fa fa-check"></i>Defining spatial neighborhoods and spatial weights</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-27-2022.html"><a href="tuesday-september-27-2022.html#computing-autocorrelation"><i class="fa fa-check"></i>Computing autocorrelation</a></li>
<li class="chapter" data-level="" data-path="tuesday-september-27-2022.html"><a href="tuesday-september-27-2022.html#spatial-lag-and-its-relation-to-autocorrelation"><i class="fa fa-check"></i>Spatial lag and its relation to autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html"><i class="fa fa-check"></i>Thursday September 29, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#other-neighbor-definitions"><i class="fa fa-check"></i>Other neighbor definitions</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#assessing-the-statistical-significance-of-autocorrelation"><i class="fa fa-check"></i>Assessing the statistical significance of autocorrelation</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#bivariate-spatial-autocorrelation"><i class="fa fa-check"></i>Bivariate spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="thursday-september-29-2022.html"><a href="thursday-september-29-2022.html#local-indicators-of-spatial-autocorrelation"><i class="fa fa-check"></i>Local indicators of spatial autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html"><i class="fa fa-check"></i>Tuesday October 4, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html#constraining-group-membership-based-on-spatial-autocorrelation"><i class="fa fa-check"></i>Constraining group membership based on spatial autocorrelation</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html#estimating-spatial-autocorrelation-in-model-residuals"><i class="fa fa-check"></i>Estimating spatial autocorrelation in model residuals</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-4-2022.html"><a href="tuesday-october-4-2022.html#choosing-a-spatial-regression-model"><i class="fa fa-check"></i>Choosing a spatial regression model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-6-2022.html"><a href="thursday-october-6-2022.html"><i class="fa fa-check"></i>Thursday October 6, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-6-2022.html"><a href="thursday-october-6-2022.html#fitting-and-interpreting-a-spatially-lagged-y-model"><i class="fa fa-check"></i>Fitting and interpreting a spatially-lagged Y model</a></li>
<li class="chapter" data-level="" data-path="thursday-october-6-2022.html"><a href="thursday-october-6-2022.html#fitting-and-interpreting-a-spatially-lagged-x-model"><i class="fa fa-check"></i>Fitting and interpreting a spatially-lagged X model</a></li>
<li class="chapter" data-level="" data-path="thursday-october-6-2022.html"><a href="thursday-october-6-2022.html#fitting-and-interpreting-spatial-durbin-models"><i class="fa fa-check"></i>Fitting and interpreting spatial Durbin models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-11-2022.html"><a href="tuesday-october-11-2022.html"><i class="fa fa-check"></i>Tuesday October 11, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-11-2022.html"><a href="tuesday-october-11-2022.html#fitting-and-interpreting-geographic-regressions"><i class="fa fa-check"></i>Fitting and interpreting geographic regressions</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-11-2022.html"><a href="tuesday-october-11-2022.html#mapping-incidence-and-risk-with-spatial-regression-models"><i class="fa fa-check"></i>Mapping incidence and risk with spatial regression models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-18-2022.html"><a href="tuesday-october-18-2022.html"><i class="fa fa-check"></i>Tuesday October 18, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-18-2022.html"><a href="tuesday-october-18-2022.html#spatial-data-as-point-patterns"><i class="fa fa-check"></i>Spatial data as point patterns</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-18-2022.html"><a href="tuesday-october-18-2022.html#working-with-point-pattern-objects-using-functions-from-the-spatstat-package"><i class="fa fa-check"></i>Working with point pattern objects using functions from the {spatstat} package</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-18-2022.html"><a href="tuesday-october-18-2022.html#quantifying-event-intensity"><i class="fa fa-check"></i>Quantifying event intensity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html"><i class="fa fa-check"></i>Thursday October 20, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#creating-ppp-and-owin-objects-from-simple-feature-data-frames"><i class="fa fa-check"></i>Creating <code>ppp</code> and <code>owin</code> objects from simple feature data frames</a></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#estimating-spatial-intensity-as-a-function-of-distance"><i class="fa fa-check"></i>Estimating spatial intensity as a function of distance</a></li>
<li class="chapter" data-level="" data-path="thursday-october-20-2022.html"><a href="thursday-october-20-2022.html#intensity-trend-as-a-possible-confounding-factor"><i class="fa fa-check"></i>Intensity trend as a possible confounding factor</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html"><i class="fa fa-check"></i>Tuesday October 25, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#estimating-the-relative-risk-of-events"><i class="fa fa-check"></i>Estimating the relative risk of events</a></li>
<li class="chapter" data-level="" data-path="tuesday-october-25-2022.html"><a href="tuesday-october-25-2022.html#estimating-second-moment-properties-of-spatial-events"><i class="fa fa-check"></i>Estimating second-moment properties of spatial events</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html"><i class="fa fa-check"></i>Thursday October 27, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#examples-of-spatially-clustered-events"><i class="fa fa-check"></i>Examples of spatially clustered events</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#determining-the-statistical-significance-of-event-clustering"><i class="fa fa-check"></i>Determining the statistical significance of event clustering</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#estimating-event-clustering-in-multi-type-event-locations"><i class="fa fa-check"></i>Estimating event clustering in multi-type event locations</a></li>
<li class="chapter" data-level="" data-path="thursday-october-27-2022.html"><a href="thursday-october-27-2022.html#more-about-the-ripley-k-function"><i class="fa fa-check"></i>More about the Ripley K function</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html"><i class="fa fa-check"></i>Tuesday November 1, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#inferring-event-interaction-from-distance-functions"><i class="fa fa-check"></i>Inferring event interaction from distance functions</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#removing-duplicate-event-locations-and-defining-the-domain"><i class="fa fa-check"></i>Removing duplicate event locations and defining the domain</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#modeling-point-pattern-data"><i class="fa fa-check"></i>Modeling point pattern data</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-1-2022.html"><a href="tuesday-november-1-2022.html#fitting-and-interpreting-an-inhibition-model"><i class="fa fa-check"></i>Fitting and interpreting an inhibition model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html"><i class="fa fa-check"></i>Thursday November 3, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#fitting-and-interpreting-a-cluster-model"><i class="fa fa-check"></i>Fitting and interpreting a cluster model</a></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#assessing-how-well-the-model-fits"><i class="fa fa-check"></i>Assessing how well the model fits</a></li>
<li class="chapter" data-level="" data-path="thursday-november-3-2022.html"><a href="thursday-november-3-2022.html#spatial-logistic-regression"><i class="fa fa-check"></i>Spatial logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html"><i class="fa fa-check"></i>Thursday November 10, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#spatial-data-interpolation"><i class="fa fa-check"></i>Spatial data interpolation</a></li>
<li class="chapter" data-level="" data-path="thursday-november-10-2022.html"><a href="thursday-november-10-2022.html#computing-the-sample-variogram"><i class="fa fa-check"></i>Computing the sample variogram</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html"><i class="fa fa-check"></i>Tuesday November 15, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#fitting-a-variogram-model-to-the-sample-variogram"><i class="fa fa-check"></i>Fitting a variogram model to the sample variogram</a></li>
<li class="chapter" data-level="" data-path="tuesday-november-15-2022.html"><a href="tuesday-november-15-2022.html#creating-an-interpolated-surface-with-the-method-of-kriging"><i class="fa fa-check"></i>Creating an interpolated surface with the method of kriging</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html"><i class="fa fa-check"></i>Thursday November 17, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html#comparing-interpolation-methods"><i class="fa fa-check"></i>Comparing interpolation methods</a></li>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html#evaluating-the-accuracy-of-the-interpolation"><i class="fa fa-check"></i>Evaluating the accuracy of the interpolation</a></li>
<li class="chapter" data-level="" data-path="thursday-november-17-2022.html"><a href="thursday-november-17-2022.html#block-cross-validation"><i class="fa fa-check"></i>Block cross validation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="thursday-november-29-2022.html"><a href="thursday-november-29-2022.html"><i class="fa fa-check"></i>Thursday November 29, 2022</a>
<ul>
<li class="chapter" data-level="" data-path="thursday-november-29-2022.html"><a href="thursday-november-29-2022.html#interpolating-to-areal-units-block-kriging"><i class="fa fa-check"></i>Interpolating to areal units (block kriging)</a></li>
<li class="chapter" data-level="" data-path="thursday-november-29-2022.html"><a href="thursday-november-29-2022.html#simulating-spatial-fields"><i class="fa fa-check"></i>Simulating spatial fields</a></li>
<li class="chapter" data-level="" data-path="thursday-november-29-2022.html"><a href="thursday-november-29-2022.html#interpolating-multiple-variables"><i class="fa fa-check"></i>Interpolating multiple variables</a></li>
<li class="chapter" data-level="" data-path="thursday-november-29-2022.html"><a href="thursday-november-29-2022.html#machine-learning-for-spatial-interpolation"><i class="fa fa-check"></i>Machine learning for spatial interpolation</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GIS5122: Applied Spatial Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="thursday-november-17-2022" class="section level1 unnumbered hasAnchor">
<h1>Thursday November 17, 2022<a href="thursday-november-17-2022.html#thursday-november-17-2022" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>“The problem of nonparametric estimation consists in estimation, from the observations, of an unknown function belonging to a sufficiently large class of functions.”</strong> - A.B. Tsybakov</p>
<p>Today</p>
<ul>
<li>Comparing interpolation methods</li>
<li>Evaluating the accuracy of the interpolation</li>
</ul>
<div id="comparing-interpolation-methods" class="section level2 unnumbered hasAnchor">
<h2>Comparing interpolation methods<a href="thursday-november-17-2022.html#comparing-interpolation-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here you consider a data set of monthly average surface air temperatures for April across the Midwest. The data are available on my website in the file <code>MidwestTemps.txt</code>.</p>
<p>Start by examining the data for spatial trends.</p>
<div class="sourceCode" id="cb1491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1491-1"><a href="thursday-november-17-2022.html#cb1491-1" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="st">&quot;http://myweb.fsu.edu/jelsner/temp/data/MidwestTemps.txt&quot;</span></span>
<span id="cb1491-2"><a href="thursday-november-17-2022.html#cb1491-2" aria-hidden="true" tabindex="-1"></a>t.sf <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_table</span>(L, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb1491-3"><a href="thursday-november-17-2022.html#cb1491-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>),</span>
<span id="cb1491-4"><a href="thursday-november-17-2022.html#cb1491-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb1491-5"><a href="thursday-november-17-2022.html#cb1491-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1491-6"><a href="thursday-november-17-2022.html#cb1491-6" aria-hidden="true" tabindex="-1"></a>XY <span class="ot">&lt;-</span> t.sf <span class="sc">|&gt;</span></span>
<span id="cb1491-7"><a href="thursday-november-17-2022.html#cb1491-7" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_coordinates</span>() </span>
<span id="cb1491-8"><a href="thursday-november-17-2022.html#cb1491-8" aria-hidden="true" tabindex="-1"></a>t.sf<span class="sc">$</span>X <span class="ot">&lt;-</span> XY[, <span class="dv">1</span>]</span>
<span id="cb1491-9"><a href="thursday-november-17-2022.html#cb1491-9" aria-hidden="true" tabindex="-1"></a>t.sf<span class="sc">$</span>Y <span class="ot">&lt;-</span> XY[, <span class="dv">2</span>]</span>
<span id="cb1491-10"><a href="thursday-november-17-2022.html#cb1491-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1491-11"><a href="thursday-november-17-2022.html#cb1491-11" aria-hidden="true" tabindex="-1"></a>t.sf<span class="sc">$</span>geometry <span class="sc">|&gt;</span></span>
<span id="cb1491-12"><a href="thursday-november-17-2022.html#cb1491-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">duplicated</span>() <span class="sc">|&gt;</span></span>
<span id="cb1491-13"><a href="thursday-november-17-2022.html#cb1491-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">any</span>()</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Plot the values on a map.</p>
<div class="sourceCode" id="cb1493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1493-1"><a href="thursday-november-17-2022.html#cb1493-1" aria-hidden="true" tabindex="-1"></a>sts <span class="ot">&lt;-</span> USAboundaries<span class="sc">::</span><span class="fu">us_states</span>()</span>
<span id="cb1493-2"><a href="thursday-november-17-2022.html#cb1493-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1493-3"><a href="thursday-november-17-2022.html#cb1493-3" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(t.sf) <span class="sc">+</span></span>
<span id="cb1493-4"><a href="thursday-november-17-2022.html#cb1493-4" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_text</span>(<span class="at">text =</span> <span class="st">&quot;temp&quot;</span>, </span>
<span id="cb1493-5"><a href="thursday-november-17-2022.html#cb1493-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb1493-6"><a href="thursday-november-17-2022.html#cb1493-6" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(sts) <span class="sc">+</span></span>
<span id="cb1493-7"><a href="thursday-november-17-2022.html#cb1493-7" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_borders</span>() </span></code></pre></div>
<p><img src="ASS-2022_files/figure-html/unnamed-chunk-678-1.png" width="672" /></p>
<p>There is a clear trend in the temperature field with the coolest values to the north. Besides the trend there is some local clustering of similar values (spatial autocorrelation).</p>
<p>Compute and plot the empirical variogram on the residuals after removing the trend. The trend term is specified in the formula as <code>temp ~ X + Y</code>.</p>
<div class="sourceCode" id="cb1494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1494-1"><a href="thursday-november-17-2022.html#cb1494-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gstat)</span>
<span id="cb1494-2"><a href="thursday-november-17-2022.html#cb1494-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1494-3"><a href="thursday-november-17-2022.html#cb1494-3" aria-hidden="true" tabindex="-1"></a>t.v <span class="ot">&lt;-</span> <span class="fu">variogram</span>(temp <span class="sc">~</span> X <span class="sc">+</span> Y, </span>
<span id="cb1494-4"><a href="thursday-november-17-2022.html#cb1494-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> t.sf)</span>
<span id="cb1494-5"><a href="thursday-november-17-2022.html#cb1494-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t.v)</span></code></pre></div>
<p><img src="ASS-2022_files/figure-html/unnamed-chunk-679-1.png" width="672" /></p>
<p>Check for anisotropy. Specify four directions and compute the corresponding directional variograms.</p>
<div class="sourceCode" id="cb1495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1495-1"><a href="thursday-november-17-2022.html#cb1495-1" aria-hidden="true" tabindex="-1"></a>t.vd <span class="ot">&lt;-</span> <span class="fu">variogram</span>(temp <span class="sc">~</span> X <span class="sc">+</span> Y, </span>
<span id="cb1495-2"><a href="thursday-november-17-2022.html#cb1495-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> t.sf,</span>
<span id="cb1495-3"><a href="thursday-november-17-2022.html#cb1495-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alpha =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">45</span>, <span class="dv">90</span>, <span class="dv">135</span>))</span>
<span id="cb1495-4"><a href="thursday-november-17-2022.html#cb1495-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> t.vd <span class="sc">|&gt;</span></span>
<span id="cb1495-5"><a href="thursday-november-17-2022.html#cb1495-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb1495-6"><a href="thursday-november-17-2022.html#cb1495-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">direction =</span> <span class="fu">factor</span>(dir.hor))</span>
<span id="cb1495-7"><a href="thursday-november-17-2022.html#cb1495-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1495-8"><a href="thursday-november-17-2022.html#cb1495-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1495-9"><a href="thursday-november-17-2022.html#cb1495-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1495-10"><a href="thursday-november-17-2022.html#cb1495-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, </span>
<span id="cb1495-11"><a href="thursday-november-17-2022.html#cb1495-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> dist, <span class="at">y =</span> gamma, <span class="at">color =</span> direction)) <span class="sc">+</span> </span>
<span id="cb1495-12"><a href="thursday-november-17-2022.html#cb1495-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb1495-13"><a href="thursday-november-17-2022.html#cb1495-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1495-14"><a href="thursday-november-17-2022.html#cb1495-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb1495-15"><a href="thursday-november-17-2022.html#cb1495-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Variogram [&quot;</span>, gamma,<span class="st">&quot;(h)]&quot;</span>))) <span class="sc">+</span></span>
<span id="cb1495-16"><a href="thursday-november-17-2022.html#cb1495-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Lag distance (h)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1495-17"><a href="thursday-november-17-2022.html#cb1495-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="ASS-2022_files/figure-html/unnamed-chunk-680-1.png" width="672" /></p>
<p>There is no strong evidence to reject the assumption of isotropy.</p>
<p>Use the <code>autofitVariogram()</code> function to get initial estimates.</p>
<div class="sourceCode" id="cb1497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1497-1"><a href="thursday-november-17-2022.html#cb1497-1" aria-hidden="true" tabindex="-1"></a>t.sp <span class="ot">&lt;-</span> <span class="fu">as</span>(t.sf, <span class="st">&quot;Spatial&quot;</span>)</span>
<span id="cb1497-2"><a href="thursday-november-17-2022.html#cb1497-2" aria-hidden="true" tabindex="-1"></a>t.vm <span class="ot">&lt;-</span> automap<span class="sc">::</span><span class="fu">autofitVariogram</span>(<span class="at">formula =</span> temp <span class="sc">~</span> X <span class="sc">+</span> Y, </span>
<span id="cb1497-3"><a href="thursday-november-17-2022.html#cb1497-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">input_data =</span> t.sp)</span>
<span id="cb1497-4"><a href="thursday-november-17-2022.html#cb1497-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t.vm)</span></code></pre></div>
<p><img src="ASS-2022_files/figure-html/unnamed-chunk-681-1.png" width="672" /></p>
<p>Set the initial parameters for a Gaussian model then fit the model.</p>
<div class="sourceCode" id="cb1498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1498-1"><a href="thursday-november-17-2022.html#cb1498-1" aria-hidden="true" tabindex="-1"></a>t.vmi <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">model =</span> <span class="st">&quot;Gau&quot;</span>, </span>
<span id="cb1498-2"><a href="thursday-november-17-2022.html#cb1498-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">psill =</span> <span class="dv">2</span>, </span>
<span id="cb1498-3"><a href="thursday-november-17-2022.html#cb1498-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">range =</span> <span class="dv">100</span>, </span>
<span id="cb1498-4"><a href="thursday-november-17-2022.html#cb1498-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">nugget =</span> <span class="dv">1</span>)</span>
<span id="cb1498-5"><a href="thursday-november-17-2022.html#cb1498-5" aria-hidden="true" tabindex="-1"></a>t.vmi</span></code></pre></div>
<pre><code>##   model psill range
## 1   Nug     1     0
## 2   Gau     2   100</code></pre>
<div class="sourceCode" id="cb1500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1500-1"><a href="thursday-november-17-2022.html#cb1500-1" aria-hidden="true" tabindex="-1"></a>t.vm <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(<span class="at">object =</span> t.v, </span>
<span id="cb1500-2"><a href="thursday-november-17-2022.html#cb1500-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model =</span> t.vmi)</span></code></pre></div>
<pre><code>## Warning in fit.variogram(object = t.v, model = t.vmi): No convergence after 200
## iterations: try different initial values?</code></pre>
<div class="sourceCode" id="cb1502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1502-1"><a href="thursday-november-17-2022.html#cb1502-1" aria-hidden="true" tabindex="-1"></a>t.vm</span></code></pre></div>
<pre><code>##   model     psill    range
## 1   Nug 0.7979039  0.00000
## 2   Gau 1.9493490 74.88767</code></pre>
<div class="sourceCode" id="cb1504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1504-1"><a href="thursday-november-17-2022.html#cb1504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t.v, t.vm)</span></code></pre></div>
<p><img src="ASS-2022_files/figure-html/unnamed-chunk-682-1.png" width="672" /></p>
<p>Make a grid for the interpolated values and add the coordinates as attributes.</p>
<div class="sourceCode" id="cb1505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1505-1"><a href="thursday-november-17-2022.html#cb1505-1" aria-hidden="true" tabindex="-1"></a>grid.sfc <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_make_grid</span>(t.sf,</span>
<span id="cb1505-2"><a href="thursday-november-17-2022.html#cb1505-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>),</span>
<span id="cb1505-3"><a href="thursday-november-17-2022.html#cb1505-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">what =</span> <span class="st">&quot;centers&quot;</span>)</span>
<span id="cb1505-4"><a href="thursday-november-17-2022.html#cb1505-4" aria-hidden="true" tabindex="-1"></a>XY <span class="ot">&lt;-</span> grid.sfc <span class="sc">|&gt;</span></span>
<span id="cb1505-5"><a href="thursday-november-17-2022.html#cb1505-5" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_coordinates</span>() </span>
<span id="cb1505-6"><a href="thursday-november-17-2022.html#cb1505-6" aria-hidden="true" tabindex="-1"></a>grid.sf <span class="ot">&lt;-</span> grid.sfc <span class="sc">|&gt;</span></span>
<span id="cb1505-7"><a href="thursday-november-17-2022.html#cb1505-7" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>() <span class="sc">|&gt;</span></span>
<span id="cb1505-8"><a href="thursday-november-17-2022.html#cb1505-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">X =</span> XY[, <span class="dv">1</span>],</span>
<span id="cb1505-9"><a href="thursday-november-17-2022.html#cb1505-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">Y =</span> XY[, <span class="dv">2</span>])</span></code></pre></div>
<p>Interpolate with universal kriging.</p>
<div class="sourceCode" id="cb1506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1506-1"><a href="thursday-november-17-2022.html#cb1506-1" aria-hidden="true" tabindex="-1"></a>t.int <span class="ot">&lt;-</span> <span class="fu">krige</span>(temp <span class="sc">~</span> X <span class="sc">+</span> Y,</span>
<span id="cb1506-2"><a href="thursday-november-17-2022.html#cb1506-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">locations =</span> t.sf,</span>
<span id="cb1506-3"><a href="thursday-november-17-2022.html#cb1506-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">newdata =</span> grid.sf,</span>
<span id="cb1506-4"><a href="thursday-november-17-2022.html#cb1506-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">model =</span> t.vm)</span></code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<p>Map the output.</p>
<div class="sourceCode" id="cb1508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1508-1"><a href="thursday-november-17-2022.html#cb1508-1" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(t.int) <span class="sc">+</span></span>
<span id="cb1508-2"><a href="thursday-november-17-2022.html#cb1508-2" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_dots</span>(<span class="at">title =</span> <span class="st">&quot;°F&quot;</span>,</span>
<span id="cb1508-3"><a href="thursday-november-17-2022.html#cb1508-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">shape =</span> <span class="dv">15</span>, </span>
<span id="cb1508-4"><a href="thursday-november-17-2022.html#cb1508-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb1508-5"><a href="thursday-november-17-2022.html#cb1508-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;var1.pred&quot;</span>, </span>
<span id="cb1508-6"><a href="thursday-november-17-2022.html#cb1508-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">n =</span> <span class="dv">9</span>, </span>
<span id="cb1508-7"><a href="thursday-november-17-2022.html#cb1508-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">palette =</span> <span class="st">&quot;OrRd&quot;</span>) <span class="sc">+</span></span>
<span id="cb1508-8"><a href="thursday-november-17-2022.html#cb1508-8" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(sts) <span class="sc">+</span></span>
<span id="cb1508-9"><a href="thursday-november-17-2022.html#cb1508-9" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb1508-10"><a href="thursday-november-17-2022.html#cb1508-10" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(t.sf) <span class="sc">+</span></span>
<span id="cb1508-11"><a href="thursday-november-17-2022.html#cb1508-11" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_text</span>(<span class="st">&quot;temp&quot;</span>, </span>
<span id="cb1508-12"><a href="thursday-november-17-2022.html#cb1508-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb1508-13"><a href="thursday-november-17-2022.html#cb1508-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1508-14"><a href="thursday-november-17-2022.html#cb1508-14" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="ASS-2022_files/figure-html/unnamed-chunk-685-1.png" width="672" /></p>
<p>The trend term captures the north-south temperature gradient and the variogram captures the local spatial autocorrelation. Together they provide the best interpolated surface.</p>
<p>To see this, you refit the interpolation without the variogram model.</p>
<div class="sourceCode" id="cb1509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1509-1"><a href="thursday-november-17-2022.html#cb1509-1" aria-hidden="true" tabindex="-1"></a><span class="fu">krige</span>(temp <span class="sc">~</span> X <span class="sc">+</span> Y,</span>
<span id="cb1509-2"><a href="thursday-november-17-2022.html#cb1509-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> t.sf,</span>
<span id="cb1509-3"><a href="thursday-november-17-2022.html#cb1509-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">newdata =</span> grid.sf) <span class="sc">|&gt;</span></span>
<span id="cb1509-4"><a href="thursday-november-17-2022.html#cb1509-4" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb1509-5"><a href="thursday-november-17-2022.html#cb1509-5" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_dots</span>(<span class="at">title =</span> <span class="st">&quot;°F&quot;</span>,</span>
<span id="cb1509-6"><a href="thursday-november-17-2022.html#cb1509-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">shape =</span> <span class="dv">15</span>, </span>
<span id="cb1509-7"><a href="thursday-november-17-2022.html#cb1509-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb1509-8"><a href="thursday-november-17-2022.html#cb1509-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;var1.pred&quot;</span>, </span>
<span id="cb1509-9"><a href="thursday-november-17-2022.html#cb1509-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">n =</span> <span class="dv">9</span>, </span>
<span id="cb1509-10"><a href="thursday-november-17-2022.html#cb1509-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">palette =</span> <span class="st">&quot;OrRd&quot;</span>) <span class="sc">+</span></span>
<span id="cb1509-11"><a href="thursday-november-17-2022.html#cb1509-11" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(sts) <span class="sc">+</span></span>
<span id="cb1509-12"><a href="thursday-november-17-2022.html#cb1509-12" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb1509-13"><a href="thursday-november-17-2022.html#cb1509-13" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(t.sf) <span class="sc">+</span></span>
<span id="cb1509-14"><a href="thursday-november-17-2022.html#cb1509-14" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_text</span>(<span class="st">&quot;temp&quot;</span>, </span>
<span id="cb1509-15"><a href="thursday-november-17-2022.html#cb1509-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb1509-16"><a href="thursday-november-17-2022.html#cb1509-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1509-17"><a href="thursday-november-17-2022.html#cb1509-17" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [ordinary or weighted least squares prediction]</code></pre>
<p><img src="ASS-2022_files/figure-html/unnamed-chunk-686-1.png" width="672" /></p>
<p>The result is that the variation in temperatures is interpolated as a simple trend surface.</p>
<p>For another comparison, here you interpolate assuming all variation is spatial autocorrelation (no trend term). This is called ordinary kriging.</p>
<div class="sourceCode" id="cb1511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1511-1"><a href="thursday-november-17-2022.html#cb1511-1" aria-hidden="true" tabindex="-1"></a><span class="fu">krige</span>(temp <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb1511-2"><a href="thursday-november-17-2022.html#cb1511-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> t.sf,</span>
<span id="cb1511-3"><a href="thursday-november-17-2022.html#cb1511-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">newdata =</span> grid.sf,</span>
<span id="cb1511-4"><a href="thursday-november-17-2022.html#cb1511-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> t.vm) <span class="sc">|&gt;</span></span>
<span id="cb1511-5"><a href="thursday-november-17-2022.html#cb1511-5" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb1511-6"><a href="thursday-november-17-2022.html#cb1511-6" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_dots</span>(<span class="at">title =</span> <span class="st">&quot;°F&quot;</span>,</span>
<span id="cb1511-7"><a href="thursday-november-17-2022.html#cb1511-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">shape =</span> <span class="dv">15</span>, </span>
<span id="cb1511-8"><a href="thursday-november-17-2022.html#cb1511-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb1511-9"><a href="thursday-november-17-2022.html#cb1511-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;var1.pred&quot;</span>, </span>
<span id="cb1511-10"><a href="thursday-november-17-2022.html#cb1511-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">n =</span> <span class="dv">9</span>, </span>
<span id="cb1511-11"><a href="thursday-november-17-2022.html#cb1511-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">palette =</span> <span class="st">&quot;OrRd&quot;</span>) <span class="sc">+</span></span>
<span id="cb1511-12"><a href="thursday-november-17-2022.html#cb1511-12" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(sts) <span class="sc">+</span></span>
<span id="cb1511-13"><a href="thursday-november-17-2022.html#cb1511-13" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb1511-14"><a href="thursday-november-17-2022.html#cb1511-14" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(t.sf) <span class="sc">+</span></span>
<span id="cb1511-15"><a href="thursday-november-17-2022.html#cb1511-15" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_text</span>(<span class="st">&quot;temp&quot;</span>, </span>
<span id="cb1511-16"><a href="thursday-november-17-2022.html#cb1511-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb1511-17"><a href="thursday-november-17-2022.html#cb1511-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1511-18"><a href="thursday-november-17-2022.html#cb1511-18" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<p><img src="ASS-2022_files/figure-html/unnamed-chunk-687-1.png" width="672" /></p>
<p>The result is that all variation is local autocorrelation. This produces patches of higher and lower temperatures.</p>
<p>The pattern obtained with ordinary kriging is similar to that obtained using inverse distance weighting. Inverse distance weighting (IDW) is a deterministic method for interpolation. The values assigned to locations are calculated with a weighted average of the values available at the known locations, where the weights are the inverse of the distance to each known location.</p>
<p>The <code>krige()</code> function does IDW when there is no trend and no variogram model given.</p>
<div class="sourceCode" id="cb1513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1513-1"><a href="thursday-november-17-2022.html#cb1513-1" aria-hidden="true" tabindex="-1"></a><span class="fu">krige</span>(temp <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb1513-2"><a href="thursday-november-17-2022.html#cb1513-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> t.sf,</span>
<span id="cb1513-3"><a href="thursday-november-17-2022.html#cb1513-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">newdata =</span> grid.sf) <span class="sc">|&gt;</span></span>
<span id="cb1513-4"><a href="thursday-november-17-2022.html#cb1513-4" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb1513-5"><a href="thursday-november-17-2022.html#cb1513-5" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_dots</span>(<span class="at">title =</span> <span class="st">&quot;°F&quot;</span>,</span>
<span id="cb1513-6"><a href="thursday-november-17-2022.html#cb1513-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">shape =</span> <span class="dv">15</span>, </span>
<span id="cb1513-7"><a href="thursday-november-17-2022.html#cb1513-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb1513-8"><a href="thursday-november-17-2022.html#cb1513-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;var1.pred&quot;</span>, </span>
<span id="cb1513-9"><a href="thursday-november-17-2022.html#cb1513-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">n =</span> <span class="dv">9</span>, </span>
<span id="cb1513-10"><a href="thursday-november-17-2022.html#cb1513-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">palette =</span> <span class="st">&quot;OrRd&quot;</span>) <span class="sc">+</span></span>
<span id="cb1513-11"><a href="thursday-november-17-2022.html#cb1513-11" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(sts) <span class="sc">+</span></span>
<span id="cb1513-12"><a href="thursday-november-17-2022.html#cb1513-12" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb1513-13"><a href="thursday-november-17-2022.html#cb1513-13" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(t.sf) <span class="sc">+</span></span>
<span id="cb1513-14"><a href="thursday-november-17-2022.html#cb1513-14" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_text</span>(<span class="st">&quot;temp&quot;</span>, </span>
<span id="cb1513-15"><a href="thursday-november-17-2022.html#cb1513-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb1513-16"><a href="thursday-november-17-2022.html#cb1513-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1513-17"><a href="thursday-november-17-2022.html#cb1513-17" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [inverse distance weighted interpolation]</code></pre>
<p><img src="ASS-2022_files/figure-html/unnamed-chunk-688-1.png" width="672" /></p>
<p>Simple kriging is ordinary kriging with a specified mean. This is done with the <code>beta =</code> argument.</p>
<div class="sourceCode" id="cb1515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1515-1"><a href="thursday-november-17-2022.html#cb1515-1" aria-hidden="true" tabindex="-1"></a><span class="fu">krige</span>(temp <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb1515-2"><a href="thursday-november-17-2022.html#cb1515-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta =</span> <span class="fu">mean</span>(t.sf<span class="sc">$</span>temp),</span>
<span id="cb1515-3"><a href="thursday-november-17-2022.html#cb1515-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> t.sf,</span>
<span id="cb1515-4"><a href="thursday-november-17-2022.html#cb1515-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">newdata =</span> grid.sf,</span>
<span id="cb1515-5"><a href="thursday-november-17-2022.html#cb1515-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> t.vm) <span class="sc">|&gt;</span></span>
<span id="cb1515-6"><a href="thursday-november-17-2022.html#cb1515-6" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_shape</span>() <span class="sc">+</span></span>
<span id="cb1515-7"><a href="thursday-november-17-2022.html#cb1515-7" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_dots</span>(<span class="at">title =</span> <span class="st">&quot;°F&quot;</span>,</span>
<span id="cb1515-8"><a href="thursday-november-17-2022.html#cb1515-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">shape =</span> <span class="dv">15</span>, </span>
<span id="cb1515-9"><a href="thursday-november-17-2022.html#cb1515-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb1515-10"><a href="thursday-november-17-2022.html#cb1515-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;var1.pred&quot;</span>, </span>
<span id="cb1515-11"><a href="thursday-november-17-2022.html#cb1515-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">n =</span> <span class="dv">9</span>, </span>
<span id="cb1515-12"><a href="thursday-november-17-2022.html#cb1515-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">palette =</span> <span class="st">&quot;OrRd&quot;</span>) <span class="sc">+</span></span>
<span id="cb1515-13"><a href="thursday-november-17-2022.html#cb1515-13" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(sts) <span class="sc">+</span></span>
<span id="cb1515-14"><a href="thursday-november-17-2022.html#cb1515-14" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb1515-15"><a href="thursday-november-17-2022.html#cb1515-15" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_shape</span>(t.sf) <span class="sc">+</span></span>
<span id="cb1515-16"><a href="thursday-november-17-2022.html#cb1515-16" aria-hidden="true" tabindex="-1"></a>  tmap<span class="sc">::</span><span class="fu">tm_text</span>(<span class="st">&quot;temp&quot;</span>, </span>
<span id="cb1515-17"><a href="thursday-november-17-2022.html#cb1515-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb1515-18"><a href="thursday-november-17-2022.html#cb1515-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1515-19"><a href="thursday-november-17-2022.html#cb1515-19" aria-hidden="true" tabindex="-1"></a>tmap<span class="sc">::</span><span class="fu">tm_layout</span>(<span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<p><img src="ASS-2022_files/figure-html/unnamed-chunk-689-1.png" width="672" /></p>
</div>
<div id="evaluating-the-accuracy-of-the-interpolation" class="section level2 unnumbered hasAnchor">
<h2>Evaluating the accuracy of the interpolation<a href="thursday-november-17-2022.html#evaluating-the-accuracy-of-the-interpolation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>How do you evaluate how good the interpolated surface is? If you use the variogram model to predict at the observation locations, you will get the observed values back.</p>
<p>For example, here you interpolate to the observation locations by setting <code>newdata = t.sf</code> instead of <code>grid.sf</code>. You then compute the correlation between the interpolated value and the observed value.</p>
<div class="sourceCode" id="cb1517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1517-1"><a href="thursday-november-17-2022.html#cb1517-1" aria-hidden="true" tabindex="-1"></a>t.int2 <span class="ot">&lt;-</span> <span class="fu">krige</span>(temp <span class="sc">~</span> X <span class="sc">+</span> Y,</span>
<span id="cb1517-2"><a href="thursday-november-17-2022.html#cb1517-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">locations =</span> t.sf,</span>
<span id="cb1517-3"><a href="thursday-november-17-2022.html#cb1517-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">newdata =</span> t.sf,</span>
<span id="cb1517-4"><a href="thursday-november-17-2022.html#cb1517-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">model =</span> t.vm)</span></code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<div class="sourceCode" id="cb1519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1519-1"><a href="thursday-november-17-2022.html#cb1519-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(t.int2<span class="sc">$</span>var1.pred, t.sf<span class="sc">$</span>temp)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>So this is not helpful.</p>
<p>Instead you use cross validation. Cross validation is a procedure for assessing how well a model does at predicting (interpolating) values when observations specific to the prediction are removed from the model fitting procedure. Cross validation partitions the data into two disjoint subsets and the model is fit to one subset of the data (training set) and the model is validated on the other subset (testing set).</p>
<p>Leave-one-out cross validation (LOOCV) uses all but one observation for fitting and the left-out observation for testing. The procedure is repeated with every observation taking turns being left out.</p>
<div class="sourceCode" id="cb1521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1521-1"><a href="thursday-november-17-2022.html#cb1521-1" aria-hidden="true" tabindex="-1"></a><span class="fu">krige.cv</span>(temp <span class="sc">~</span> X <span class="sc">+</span> Y,</span>
<span id="cb1521-2"><a href="thursday-november-17-2022.html#cb1521-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">locations =</span> t.sf,</span>
<span id="cb1521-3"><a href="thursday-november-17-2022.html#cb1521-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">model =</span> t.vm) <span class="sc">|&gt;</span></span>
<span id="cb1521-4"><a href="thursday-november-17-2022.html#cb1521-4" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb1521-5"><a href="thursday-november-17-2022.html#cb1521-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">r =</span> <span class="fu">cor</span>(var1.pred, observed),</span>
<span id="cb1521-6"><a href="thursday-november-17-2022.html#cb1521-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rmse =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((var1.pred <span class="sc">-</span> observed)<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb1521-7"><a href="thursday-november-17-2022.html#cb1521-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mae =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(var1.pred <span class="sc">-</span> observed)))</span></code></pre></div>
<pre><code>##           r     rmse      mae
## 1 0.9452588 1.308603 1.027777</code></pre>
<div class="sourceCode" id="cb1523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1523-1"><a href="thursday-november-17-2022.html#cb1523-1" aria-hidden="true" tabindex="-1"></a><span class="fu">krige.cv</span>(temp <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb1523-2"><a href="thursday-november-17-2022.html#cb1523-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">locations =</span> t.sf,</span>
<span id="cb1523-3"><a href="thursday-november-17-2022.html#cb1523-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">model =</span> t.vm) <span class="sc">|&gt;</span></span>
<span id="cb1523-4"><a href="thursday-november-17-2022.html#cb1523-4" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb1523-5"><a href="thursday-november-17-2022.html#cb1523-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">r =</span> <span class="fu">cor</span>(var1.pred, observed),</span>
<span id="cb1523-6"><a href="thursday-november-17-2022.html#cb1523-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rmse =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((var1.pred <span class="sc">-</span> observed)<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb1523-7"><a href="thursday-november-17-2022.html#cb1523-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mae =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(var1.pred <span class="sc">-</span> observed)))</span></code></pre></div>
<pre><code>##           r     rmse      mae
## 1 0.9018904 1.903057 1.403527</code></pre>
<div class="sourceCode" id="cb1525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1525-1"><a href="thursday-november-17-2022.html#cb1525-1" aria-hidden="true" tabindex="-1"></a><span class="fu">krige.cv</span>(temp <span class="sc">~</span> X <span class="sc">+</span> Y,</span>
<span id="cb1525-2"><a href="thursday-november-17-2022.html#cb1525-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">locations =</span> t.sf) <span class="sc">|&gt;</span></span>
<span id="cb1525-3"><a href="thursday-november-17-2022.html#cb1525-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb1525-4"><a href="thursday-november-17-2022.html#cb1525-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">r =</span> <span class="fu">cor</span>(var1.pred, observed),</span>
<span id="cb1525-5"><a href="thursday-november-17-2022.html#cb1525-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rmse =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((var1.pred <span class="sc">-</span> observed)<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb1525-6"><a href="thursday-november-17-2022.html#cb1525-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mae =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(var1.pred <span class="sc">-</span> observed)))</span></code></pre></div>
<pre><code>##           r     rmse      mae
## 1 0.9057414 1.698922 1.351733</code></pre>
<div class="sourceCode" id="cb1527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1527-1"><a href="thursday-november-17-2022.html#cb1527-1" aria-hidden="true" tabindex="-1"></a><span class="fu">krige.cv</span>(temp <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb1527-2"><a href="thursday-november-17-2022.html#cb1527-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">locations =</span> t.sf) <span class="sc">|&gt;</span></span>
<span id="cb1527-3"><a href="thursday-november-17-2022.html#cb1527-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb1527-4"><a href="thursday-november-17-2022.html#cb1527-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">r =</span> <span class="fu">cor</span>(var1.pred, observed),</span>
<span id="cb1527-5"><a href="thursday-november-17-2022.html#cb1527-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rmse =</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((var1.pred <span class="sc">-</span> observed)<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb1527-6"><a href="thursday-november-17-2022.html#cb1527-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mae =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(var1.pred <span class="sc">-</span> observed)))</span></code></pre></div>
<pre><code>##           r     rmse      mae
## 1 0.9294513 1.785536 1.346272</code></pre>
<p>All four interpolations result in high correlation between observed and interpolated values that exceed .9 and root-mean-squared errors (RMSE) less than 1.8. But the universal kriging interpolation gives the highest correlation and the lowest RMSE and mean-absolute errors.</p>
<p>For a visual representation of the goodness of fit you plot the observed versus interpolated values from the cross validation procedure.</p>
<div class="sourceCode" id="cb1529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1529-1"><a href="thursday-november-17-2022.html#cb1529-1" aria-hidden="true" tabindex="-1"></a><span class="fu">krige.cv</span>(temp <span class="sc">~</span> X <span class="sc">+</span> Y,</span>
<span id="cb1529-2"><a href="thursday-november-17-2022.html#cb1529-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">locations =</span> t.sf,</span>
<span id="cb1529-3"><a href="thursday-november-17-2022.html#cb1529-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">model =</span> t.vm) <span class="sc">|&gt;</span></span>
<span id="cb1529-4"><a href="thursday-november-17-2022.html#cb1529-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">interpolated =</span> var1.pred) <span class="sc">|&gt;</span></span>
<span id="cb1529-5"><a href="thursday-november-17-2022.html#cb1529-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> observed, <span class="at">y =</span> interpolated)) <span class="sc">+</span> </span>
<span id="cb1529-6"><a href="thursday-november-17-2022.html#cb1529-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1529-7"><a href="thursday-november-17-2022.html#cb1529-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1529-8"><a href="thursday-november-17-2022.html#cb1529-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1529-9"><a href="thursday-november-17-2022.html#cb1529-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Interpolated temperatures (°F)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1529-10"><a href="thursday-november-17-2022.html#cb1529-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Observed temperatures (°F)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1529-11"><a href="thursday-november-17-2022.html#cb1529-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="ASS-2022_files/figure-html/unnamed-chunk-692-1.png" width="672" /></p>
<p>The black line represents a perfect prediction and the red line is the best fit line when you regress the interpolated temperatures onto the observed temperatures. The fact that the two lines nearly coincide indicates the interpolation is good.</p>
<p>The <code>nfold =</code> argument, which by default is set to the number of observations and does a LOOCV, allows you to divide the data into different size folds (instead of N-1).</p>
<p>Note that these performance metrics are biased toward the sample of data because cross validation is done only on the interpolation (kriging) and not on the variogram model fitting.</p>
<p>That is, with kriging the data is used in two ways (1) to fit the variogram model, and (2) to interpolate the values.</p>
<p>To perform a full LOOCV you need to refit the variogram after removing the observation for which you want the interpolation.</p>
<div class="sourceCode" id="cb1531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1531-1"><a href="thursday-november-17-2022.html#cb1531-1" aria-hidden="true" tabindex="-1"></a>vmi <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">model =</span> <span class="st">&quot;Sph&quot;</span>, </span>
<span id="cb1531-2"><a href="thursday-november-17-2022.html#cb1531-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">psill =</span> <span class="dv">2</span>, </span>
<span id="cb1531-3"><a href="thursday-november-17-2022.html#cb1531-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">range =</span> <span class="dv">200</span>, </span>
<span id="cb1531-4"><a href="thursday-november-17-2022.html#cb1531-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">nugget =</span> <span class="dv">1</span>)</span>
<span id="cb1531-5"><a href="thursday-november-17-2022.html#cb1531-5" aria-hidden="true" tabindex="-1"></a>int <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb1531-6"><a href="thursday-november-17-2022.html#cb1531-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(t.sf)){</span>
<span id="cb1531-7"><a href="thursday-november-17-2022.html#cb1531-7" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> t.sf[<span class="sc">-</span>i, ]</span>
<span id="cb1531-8"><a href="thursday-november-17-2022.html#cb1531-8" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">variogram</span>(temp <span class="sc">~</span> X <span class="sc">+</span> Y, </span>
<span id="cb1531-9"><a href="thursday-november-17-2022.html#cb1531-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> t)</span>
<span id="cb1531-10"><a href="thursday-november-17-2022.html#cb1531-10" aria-hidden="true" tabindex="-1"></a>  vm <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(<span class="at">object =</span> v, </span>
<span id="cb1531-11"><a href="thursday-november-17-2022.html#cb1531-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">model =</span> vmi)</span>
<span id="cb1531-12"><a href="thursday-november-17-2022.html#cb1531-12" aria-hidden="true" tabindex="-1"></a>  int[i] <span class="ot">&lt;-</span> <span class="fu">krige</span>(temp <span class="sc">~</span> X <span class="sc">+</span> Y,</span>
<span id="cb1531-13"><a href="thursday-november-17-2022.html#cb1531-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">locations =</span> t,</span>
<span id="cb1531-14"><a href="thursday-november-17-2022.html#cb1531-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">newdata =</span> t[i, ],</span>
<span id="cb1531-15"><a href="thursday-november-17-2022.html#cb1531-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">model =</span> vm)<span class="sc">$</span>var1.pred</span>
<span id="cb1531-16"><a href="thursday-november-17-2022.html#cb1531-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The interpolation error using full cross validation will always be larger than the interpolation error using a fixed variogram model.</p>
</div>
<div id="block-cross-validation" class="section level2 unnumbered hasAnchor">
<h2>Block cross validation<a href="thursday-november-17-2022.html#block-cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One final note about cross validation in the context of spatial data is the observations are not independent. As such it is better to create spatial areas for training separate from the spatial areas for testing.</p>
<p>A nice introduction to so-called ‘block’ cross validation in the context of species distribution modeling is available here
<a href="https://cran.r-project.org/web/packages/blockCV/vignettes/BlockCV_for_SDM.html" class="uri">https://cran.r-project.org/web/packages/blockCV/vignettes/BlockCV_for_SDM.html</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tuesday-november-15-2022.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="thursday-november-29-2022.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
